---
import BaseLayout from '../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';

// Get featured projects for preview
const projects = await getCollection('projects');
const featuredProjects = projects.filter(p => p.data.featured).sort((a, b) => b.data.order - a.data.order);

// Get experience entries
const experiences = await getCollection('experience');
const sortedExperiences = experiences.sort((a, b) => b.data.order - a.data.order);
---

<BaseLayout
  title="David Garibay - Senior SDET | Test Automation"
  description="David Garibay is a Senior SDET specializing in test automation frameworks, modern web applications, and developer productivity tools. Building with React, TypeScript, Playwright, and more."
>
  <div class="min-h-screen">
    <!-- Hero Section -->
    <section class="px-6 pt-12 md:pt-0 md:flex md:items-center md:justify-center md:min-h-screen relative">
      <div class="container mx-auto max-w-5xl">
        <div class="grid md:grid-cols-2 gap-8 md:gap-16 items-center">
          <!-- Profile Picture - First on mobile, second on desktop -->
          <div class="flex justify-center md:justify-end order-1 md:order-2">
            <div class="relative">
              <img
                src="/me.jpg"
                alt="David Garibay"
                class="w-64 h-64 md:w-80 md:h-80 object-cover rounded-full"
              />
            </div>
          </div>

          <!-- Text Content - Second on mobile, first on desktop -->
          <div class="space-y-8 order-2 md:order-1 text-center md:text-left">
            <div>
              <p class="text-text-tertiary text-xs uppercase tracking-[0.15em] mb-6 font-semibold">Senior SDET</p>
              <h1 class="text-6xl md:text-8xl font-extrabold mb-8 leading-[0.95] tracking-[-0.03em]">
                David<br />Garibay
              </h1>
              <p class="text-xl md:text-2xl leading-relaxed font-normal h-16 md:h-20">
                <span class="text-text-secondary">Building </span><span id="typed-text" class="text-zen-coral font-medium"></span>
              </p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Key Stats/Highlights -->
    <section class="py-24 px-6 border-t border-zen-subtle">
      <div class="container mx-auto max-w-5xl">
        <div class="grid md:grid-cols-3 gap-12 lg:gap-16">
          <div>
            <h2 class="text-5xl md:text-6xl font-extrabold mb-4 tracking-[-0.02em]">7+</h2>
            <p class="text-text-secondary text-base font-medium">Years in Quality Engineering</p>
          </div>
          <div>
            <h2 class="text-5xl md:text-6xl font-extrabold mb-4 tracking-[-0.02em]">15+</h2>
            <p class="text-text-secondary text-base font-medium">Automation Frameworks & Tools Built</p>
          </div>
          <div>
            <h2 class="text-5xl md:text-6xl font-extrabold mb-4 tracking-[-0.02em]">4</h2>
            <p class="text-text-secondary text-base font-medium">Open Source Projects</p>
          </div>
        </div>
      </div>
    </section>

    <!-- Selected Work -->
    <section class="py-24 px-6 border-t border-zen-subtle">
      <div class="container mx-auto max-w-5xl">
        <div class="mb-16">
          <h2 class="text-4xl md:text-5xl font-extrabold mb-4 tracking-[-0.02em]">Selected Work</h2>
          <p class="text-text-secondary text-base font-medium">Recent projects and automation frameworks.</p>
        </div>

        <div class="space-y-12">
          {featuredProjects.slice(0, 3).map((project) => (
            <a
              href={`/projects/${project.slug}`}
              class="block group"
            >
              <div class="pb-8">
                <div class="flex justify-between items-start mb-4">
                  <h3 class="text-2xl md:text-3xl font-bold group-hover:text-zen-coral transition-colors tracking-[-0.01em]">{project.data.title}</h3>
                  <span class="text-text-tertiary group-hover:text-zen-coral transition-colors text-2xl">→</span>
                </div>
                <p class="text-text-secondary mb-4 leading-relaxed max-w-3xl font-normal">{project.data.description}</p>
                <div class="flex flex-wrap gap-3">
                  {project.data.technologies.map((tech) => (
                    <span class="text-text-tertiary text-sm font-medium">
                      {tech}
                    </span>
                  ))}
                </div>
              </div>
            </a>
          ))}
        </div>

        <div class="mt-16">
          <a
            href="/projects"
            class="text-text-primary hover:text-text-secondary transition-colors text-lg font-medium underline underline-offset-4"
          >
            View All Projects
          </a>
        </div>
      </div>
    </section>

    <!-- Current Role -->
    <section class="py-24 px-6 border-t border-zen-subtle">
      <div class="container mx-auto max-w-5xl">
        <div class="mb-16">
          <h2 class="text-4xl md:text-5xl font-extrabold mb-4 tracking-[-0.02em]">Current Role</h2>
        </div>

        {sortedExperiences.slice(0, 1).map((exp) => (
          <div class="space-y-6">
            <div>
              <h3 class="text-2xl md:text-3xl font-bold mb-2 tracking-[-0.01em]">{exp.data.position}</h3>
              <p class="text-zen-coral text-xl mb-2 font-semibold">{exp.data.company}</p>
              <p class="text-text-tertiary font-medium">
                {exp.data.startDate.toLocaleDateString('en-US', { month: 'short', year: 'numeric' })} - Present
              </p>
            </div>
            <div class="flex flex-wrap gap-3">
              {exp.data.technologies.map((tech) => (
                <span class="text-text-secondary text-sm font-medium">
                  {tech}
                </span>
              ))}
            </div>
          </div>
        ))}

        <div class="mt-16">
          <a
            href="/experience"
            class="text-text-primary hover:text-text-secondary transition-colors text-lg font-medium underline underline-offset-4"
          >
            View All Experience
          </a>
        </div>
      </div>
    </section>

    <!-- Contact CTA -->
    <section class="py-24 px-6 border-t border-zen-subtle">
      <div class="container mx-auto max-w-5xl">
        <div class="max-w-3xl">
          <h2 class="text-4xl md:text-6xl font-extrabold mb-8 leading-tight tracking-[-0.02em]">
            Get in touch
          </h2>
          <p class="text-text-secondary text-lg md:text-xl mb-10 leading-relaxed font-normal">
            Always happy to chat about testing strategies, automation frameworks, or interesting projects.
          </p>
          <div class="flex gap-6 flex-wrap">
            <a
              href="https://www.linkedin.com/in/david--garibay/"
              target="_blank"
              rel="noopener noreferrer"
              class="text-zen-coral hover:text-zen-coral-hover transition-colors text-base font-semibold"
            >
              LinkedIn →
            </a>
            <a
              href="https://github.com/davidgaribay-dev"
              target="_blank"
              rel="noopener noreferrer"
              class="text-zen-coral hover:text-zen-coral-hover transition-colors text-base font-semibold"
            >
              GitHub →
            </a>
          </div>
        </div>
      </div>
    </section>
  </div>
</BaseLayout>

<script>
  import Typed from 'typed.js';

  new Typed('#typed-text', {
    strings: [
      'robust automation frameworks.',
      'agentic AI tools.',
      'developer tools that enhance productivity and software quality.',
      'modern web applications.',
      'knowledge bases.',
    ],
    typeSpeed: 30,
    backSpeed: 20,
    backDelay: 1500,
    startDelay: 300,
    loop: true,
    showCursor: true,
    cursorChar: '|',
  });
</script>
